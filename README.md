# Joint-model-for-multiple-trait-genetics

This Github repository includes Examples of R scripts for Data Simulation under multiple-trait genetics scenario & to fit a Joint Model for multiple longitudinal and multiple time-to-event traits using the two-stage approach with estimation of the variance-covariance matrix by bootstrap, see details in the paper (in revision): "Characterization of direct and/or indirect genetic associations for multiple traits in longitudinal studies of disease progression"
by Myriam Brossard, Andrew D. Paterson, Osvaldo Espin-Garcia, Radu V. Craiu, Shelley B. Bull

./simulation: This directory includes:
- the R script used to generate replicates of datasets with K=2 simulated time-to-event traits (retinopathy, nephropathy) & simulated genotyped data at M=5 SNPs with direct and/or indirect effects via L=3 longitudinal risk factors: 2 observed in DCCT (hba1c, SBP) and one simulated (U), see Fig. 3 from Brossard et al. This script also simulates genotypes for 5 SNPs with the same MAFS as the causal SNPs under the global null hypothesis (referred as SNP1R-SNP5R)
- an ariticial DCCT dataset used as input to illustrate the simulation procedure based on observed longitudunal Hba1c and SBP values & 2 baseline covariates (SEX, T1D_diagnosis) for N=xxx DCCT individuals ()
- an example of output dataset generated by the script for R=5 simulation replicates (using the same simulation parameters as in Brossard et al,)

./JM_analysis: This directory includes:
- a main R script that fits a joint model of L=2 longitudinal QT (HbA1c, SBP) and K=2 time-to-event traits (DR, DN) for 1 simulation replicate & SNP5A from xxxx
- a R script with some sub-functions to fit the joint model & the R script that mvlme.r from xxx for multivariate mixed model
- an example of results produced by the ZZZZZ

Comments in the scripts help to interpret the different outputs
