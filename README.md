# Joint-model-for-multiple-trait-genetics

This Github repository includes Examples of R scripts to generate the DCCT-based simulated datasets under a multiple-trait genetics scenario, as described in the paper (under revision): "Characterization of direct and/or indirect genetic associations for multiple traits in longitudinal studies of disease progression" by Myriam Brossard, Andrew D. Paterson, Osvaldo Espin-Garcia, Radu V. Craiu, Shelley B. Bull, & to fit a Joint Model for multiple longitudinal and multiple time-to-event traits using the two-stage approach with estimation of the variance-covariance matrix by the bootstrap. This repository includes two main directories:

./simulation includes:
- the R script "data_simulation.r" used to generate R=1000 data replicates of N=667 DCCT individuals with K=2 simulated time-to-event traits (retinopathy, nephropathy) & simulated genotypes at M=5 SNPs with direct and/or indirect effects via L=3 longitudinal risk factors: 2 observed in DCCT (HbA1c, SBP) and one simulated (U), see Fig. 3 from Brossard et al. This script also produces simulated genotypes at 5 SNPs with the same MAFs as the causal SNPs under the global null hypothesis (referred as SNP1R-SNP5R).
- "DCCT_ARTIFICIAL_longQT.Rdata", an aritificial DCCT dataset with simulated longitudinal &  baseline covariates values (SEX, T1D_diagnosis) in N=667 DCCT individuals, used to illustrate the simulation procedure.
- "DCCT_based_simulated_data_reps5.Rdata", an example of output dataset generated by "data_simulation.r" with R=5 data replicates. 

./JM_analysis includes:
- the R script "example_JMfit.r", which illustates an application of a Joint Model of L=2 longitudinal quantitative traits (HbA1c, SBP), and K=2 time-to-event traits (DR, DN) for causal SNP5A (with direct and indirect effects on time-to-DN via SBP) to 1 simulation replicate from "DCCT_based_simulated_data_reps5.Rdata"
- the R script "example_JMfit_subfunctions.r" which includes the sub-functions used to fit the Joint Model 
- the R script "mvlme.r" that includes the function mvlme() to fit a multivariate longitudinal mixed model, from the JoineRML R package (Version 0.4.2 on CRAN)  
- output file "JM_results_SNP5A_replicate1.Rdata" produced by "example_JMfit.r", that includes the joint model results 

Comments in the scripts help to interpret the different outputs
